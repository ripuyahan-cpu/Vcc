const { Telegraf } = require('telegraf');
const { faker } = require('@faker-js/faker');

// ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶¨‡¶ü ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶®
const bot = new Telegraf('8578271054:AAF8NtbAQ4pEUZpzfbNzdC8Iw-pK6BZ9Glw');

/**
 * Luhn Algorithm: ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡¶ü‡¶ø ‡¶¨‡ßà‡¶ß ‡¶ï‡¶ø ‡¶®‡¶æ ‡¶§‡¶æ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
 */
function luhnChecksum(code) {
    let len = code.length;
    let parity = len % 2;
    let sum = 0;
    for (let i = 0; i < len; i++) {
        let d = parseInt(code[i]);
        if (i % 2 === parity) d *= 2;
        if (d > 9) d -= 9;
        sum += d;
    }
    return sum % 10;
}

/**
 * VCC Generator Function
 */
function generateVCC(bin) {
    let cardNumber = bin.toString();
    
    // ‡ßß‡ß´ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ
    while (cardNumber.length < 15) {
        cardNumber += Math.floor(Math.random() * 10).toString();
    }
    
    // ‡ßß‡ß¨‡¶§‡¶Æ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü (Check Digit) ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶≤‡ßÅ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶ó‡¶∞‡¶ø‡¶¶‡¶Æ ‡¶¶‡¶ø‡ßü‡ßá
    let checksum = luhnChecksum(cardNumber + '0');
    let checkDigit = (10 - checksum) % 10;
    cardNumber += checkDigit;

    const month = String(Math.floor(Math.random() * 12) + 1).padStart(2, '0');
    const year = Math.floor(Math.random() * (2030 - 2025 + 1)) + 2025;
    const cvv = Math.floor(Math.random() * (999 - 100 + 1)) + 100;

    return { cardNumber, month, year, cvv };
}

// ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßç‡¶ü ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶°
bot.start((ctx) => {
    ctx.replyWithMarkdownV2(
        'üí≥ *VCC Generator Bot*\n\n' +
        '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ü‡¶æ‡¶á‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®: `/gen BIN` \n' +
        '‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: `/gen 440393`'
    );
});

// ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶°
bot.command('gen', (ctx) => {
    const message = ctx.message.text.split(' ');
    const bin = message[1];

    if (!bin || isNaN(bin) || bin.length < 1) {
        return ctx.reply('‚ùå ‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶†‡¶ø‡¶ï BIN ‡¶¶‡¶ø‡¶®‡•§ ‡¶Ø‡ßá‡¶Æ‡¶®: /gen 440393');
    }

    const card = generateVCC(bin);
    const name = faker.person.fullName();
    const country = faker.location.country();

    const response = 
        `‚úÖ *Generated Card Details*\n` +
        `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
        `üí≥ *Number:* \`${card.cardNumber}\`\n` +
        `üìÖ *Date:* \`${card.month}/${card.year}\`\n` +
        `üîí *CVV:* \`${card.cvv}\`\n` +
        `üë§ *Name:* ${name}\n` +
        `üìç *Country:* ${country}\n` +
        `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
        `üî• _Generated by Professional JS Bot_`;

    ctx.replyWithMarkdown(response);
});

// ‡¶¨‡¶ü ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ
bot.launch().then(() => {
    console.log('Bot is running online...');
});

// ‡¶ó‡ßç‡¶∞‡ßá‡¶∏‡¶´‡ßÅ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶™
process.once('SIGINT', () => bot.stop('SIGINT'));
process.once('SIGTERM', () => bot.stop('SIGTERM'));
